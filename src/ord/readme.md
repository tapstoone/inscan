code borrowed from https://github.com/ordinals/ord/tree/bea2ec5500b827a78c9766622d2a830b613d15d4